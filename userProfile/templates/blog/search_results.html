{% extends "base.html" %}

{% load i18n future mezzanine_tags static %}
{% load follow_tags %}
{% load hitcount_tags %}
{% block meta_title %}{% trans "Search Results" %}{% endblock %}
{% block title %}{% trans "Search Results" %}{% endblock %}

{% block breadcrumb_menu %}
<li>
    <a href="{% url "home" %}">{% trans "Home" %}</a>
    <span class="divider">/</span>
</li>
<li class="active">{% trans "Search Results" %}</li>
{% endblock %}

{% block main %}
<link rel="stylesheet" type="text/css" href="{% static "css/searchresults.css" %}"/>
<link rel="stylesheet" href="{% static "css/navigation.css" %}"/>
<p>
{% if results.paginator.count == 0 %}
{% blocktrans %}
No results were found in {{ search_type }} matching your query: {{ query }}
{% endblocktrans %}
{% else %}
{% blocktrans with start=results.start_index end=results.end_index total=results.paginator.count %}
Showing {{ start }} to {{ end }} of {{ total }} results in {{ search_type }} matching your query: {{ query }}
{% endblocktrans %}
{% endif %}
</p>

<div id="search-results">
    {% for result in results.object_list %}
    <div class="search-result row">
    	<div class="span1">
		{% if settings.BLOG_USE_FEATURED_IMAGE and result.featured_image %}
			<img src="{{ MEDIA_URL }}{% thumbnail result.featured_image 100 0 %}">
		{% else %}
			IMAGE
		{% endif %}
		</div>
		<div class="span8">
		    <div>
		    	<div class="rank">{{ forloop.counter0|add:results.start_index }}</div>
		        <a class="vendorName" href="{{ result.get_absolute_url }}">{{ result }}</a>
		        <span class="searchResultRating searchResultRatingText searchResultRatingScheme rating-{{result.overall_average|floatformat:"0"}}">{{result.overall_average|floatformat:"1"}}</span>
		    </div>
		    <p class="resultDesc">{{ result.description|truncatewords_html:20|safe }}</p>
		    <a href="{{ result.get_absolute_url }}">{% trans "read more" %}</a>
		   	<div class="vendorInfo">
		    	<span class="infoItem">
		    	<a href="{{ result.get_absolute_url }}#comments">{% spaceless %}
		            {% blocktrans count result.comments_count as comments_count %}1 review{% plural %}{{ comments_count }} reviews{% endblocktrans %}
		            {% endspaceless %}</a>
		        </span>
		    	<span class="infoItem">
		    		{% vendor_follower_subset_info_url result 0 request.user|follower_count:result as subset_follower_url %}
			        <a id="vendor{{ forloop.counter0|add:results.start_index }}" class="vendorFollowers" href="{{subset_follower_url}}">{{ request.user|follower_count:result }}  Follower{{ request.user|follower_count:result|pluralize }}</a>
			    </span>
			    <span class ="infoItem cover-stat cover-stat-views">
			        <span class="stat-label be-font-inline">G</span>
      				<span class="stat-value">{% get_hit_count for result %}</span>
			    </span>
				<div class="followContainer follow-button-container action-follow-user {% if request.user|is_following:result %} following {% endif %}" >
					<a href="{% follow_url result %}" data-id="vendor{{ forloop.counter0|add:results.start_index }}" class="follow-btn form-button form-button-follow form-button-small form-button-default form-button-left-icon form-button-icon-follow">Follow</a>
				    <a class="form-button form-button-following form-button-small form-button-light-and-grey form-button-left-icon form-button-icon-following">Following</a>
				    <a href="{% follow_url result %}" data-id="vendor{{ forloop.counter0|add:results.start_index }}" class="unfollow-btn form-button form-button-unfollow form-button-small form-button-red form-button-left-icon form-button-icon-unfollow">Unfollow</a>
				</div>
			</div>
		</div>
		<hr class="dottedSeparator">
	 </div>
    {% endfor %}
</div>

{% pagination_for results %}

{% endblock %}
